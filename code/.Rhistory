mda <- read.delim('mda-uncertainty-terms-count.txt', stringsAsFactors = FALSE)
mda$year <- as.numeric(substr(mda$filename, 12,13))
table(mda$year)
mda$year <- ifelse(mda$year <= 17, mda$year + 2000, mda$year + 1900)
table(mda$year)
mda <- mda[order(mda$year),]
plot(mda$year, mda$n_unc_terms, type='l', col='red', lwd=3)
summary(mda)
nterms <- aggregate(mda$n_unc_terms, by = list(mda$year), FUN = sum)
names(nterms) <- c('year', 'n_unc_terms')
plot(nterms$year, nterms$n_unc_terms, type='l', col='red', lwd=3)
pterms <- aggregate(mda$p_unc_terms, by = list(mda$year), FUN = mean)
names(pterms) <- c('year', 'p_unc_terms')
plot(pterms$year, pterms$p_unc_terms, type='l', col='red', lwd=3)
mda <- read.delim('mda-uncertainty-terms-count.txt', stringsAsFactors = FALSE)
summary(mda)
mda$year <- as.numeric(substr(mda$filename, 12,13))
mda$year <- ifelse(mda$year <= 17, mda$year + 2000, mda$year + 1900)
table(mda$year)
mda <- mda[order(mda$year),]
nterms <- aggregate(mda$n_unc_terms, by = list(mda$year), FUN = sum)
names(nterms) <- c('year', 'n_unc_terms')
plot(nterms$year, nterms$n_unc_terms, type='l', col='red', lwd=3)
pterms <- aggregate(mda$p_unc_terms, by = list(mda$year), FUN = mean)
names(pterms) <- c('year', 'p_unc_terms')
plot(pterms$year, pterms$p_unc_terms, type='l', col='red', lwd=3)
(mda.year.table <- table(mda$year))
plot(mda.year.table)
View(mda)
comp.metadata <- read.delim("../../../data/compustat-urls-db-fixedfyear.txt")
comp.metadata <- read.delim("../../../metadata/compustat-urls-db-fixedfyear.txt")
View(comp.metadata)
X <- merge(comp.metadata, mda, by = c("filename"))
View(X)
mda <- X
rm("X")
(mda.year.table <- table(mda$fyear))
plot(mda.year.table)
mda <- mda[order(mda$fyear),]
names(mda)
head(mda$filingdate)
mda <- read.delim('mda-uncertainty-terms-count.txt', stringsAsFactors = FALSE)
comp.metadata <- read.delim("../../../metadata/compustat-urls-db-fixedfyear.txt", stringsAsFactors = FALSE)
X <- merge(comp.metadata, mda, by = c("filename"))
mda <- X
rm("X")
(mda.year.table <- table(mda$fyear))
plot(mda.year.table)
mda <- mda[order(mda$fyear),]
head(mda$filingdate)
a <- mda[1,"filingdate"]
a
gsub('\-',a)
gsub(a,'\-')
sub('\-',a)
sub(a,'\-')
sub('\-',a)
sub('-',a)
sub('[0-9]{4}-',a,'\1')
a
sub('[0-9]{4}-[0-9]{2}',a,'\2')
sub('[0-9]{4}-[0-9]{2}',a,'\3')
sub('[0-9]{4}-[0-9]{2}','\2',a)
sub('[0-9]{4}-[0-9]{2}','\1',a)
sub('[0-9]{4}\-[0-9]{2}','\1',a)
sub(r'[0-9]{4}\-[0-9]{2}','\1',a)
sub('([0-9]{4})-([0-9]{2})','\2',a)
gsub('([0-9]{4})-([0-9]{2})','\2',a)
grep('([0-9]{4})-',a)
a[grep('([0-9]{4})-',a)]
strsplit(a,'-')
strsplit(a,'-')[2]
strsplit(a,'-')[[2]]
strsplit(a,'-')[[1]][2]
substr(a,6,7)
month <- substr(mda$filingdate, 6, 7)
table(month)
mda$year <- substr(mda$filingdate, 1, 4)
mda$filingyear <- substr(mda$filingdate, 1, 4)
table(mda$filingyear)
filingmonth <- substr(mda$filingdate, 6, 7)
mda$filingmonth <- filingmonth
yearmo <- paste(mda$filingyear, mda$filingmonth, sep='')
table(yearmo)
plot(table(yearmo))
barplot(table(yearmo))
mda$yearmo <- yearmo
mda$filingyearmo <- yearmo
a <- 1:12
a
a%3
a%%3
a%%12
a/3
ceil(a/3)
round(a/3)
a
ceiling(a)
ceiling(a/3)
filingquarter <- ceiling(mda$filingmonth/3)
filingquarter <- ceiling(as.numeric(mda$filingmonth)/3)
table(filingquarter)
mda$filingquarter <- filingquarter
nterms.by.month <- aggregate(mda$n_unc_terms, by = list(mda$filingmonth), FUN = sum)
names(nterms.by.month) <- c('filingmonth', 'n_unc_terms')
plot(nterms$filingmonth, nterms$n_unc_terms, type='l', col='red', lwd=3)
plot(nterms.by.month$filingmonth, nterms.by.month$n_unc_terms, type='l', col='red', lwd=3)
nterms.by.month <- aggregate(mda$n_unc_terms, by = list(mda$filingyearmo), FUN = sum)
names(nterms.by.month) <- c('filingyearmo', 'n_unc_terms')
plot(nterms.by.month$filingyearmo, nterms.by.month$n_unc_terms, type='l', col='red', lwd=3)
View(nterms)
View(nterms.by.month)
pterms.by.month <- aggregate(mda$p_unc_terms, by = list(mda$filingyearmo), FUN = mean)
names(pterms.by.month) <- c('filingyearmo', 'p_unc_terms')
plot(pterms$filingyearmo, pterms$p_unc_terms, type='l', col='red', lwd=3)
plot(pterms.by.month$filingyearmo, pterms.by.month$p_unc_terms, type='l', col='red', lwd=3)
nterms.by.month <- aggregate(mda$n_unc_terms, by = list(mda$filingyearmo), FUN = mean)
names(nterms.by.month) <- c('filingyearmo', 'n_unc_terms')
plot(nterms.by.month$filingyearmo, nterms.by.month$n_unc_terms, type='l', col='red', lwd=3)
nterms.by.month <- aggregate(mda$n_unc_terms, by = list(mda$filingyearmo), FUN = median)
names(nterms.by.month) <- c('filingyearmo', 'n_unc_terms')
plot(nterms.by.month$filingyearmo, nterms.by.month$n_unc_terms, type='l', col='red', lwd=3)
nterms.by.year <- aggregate(mda$n_unc_terms, by = list(mda$filingyear), FUN = mean)
names(nterms.by.year) <- c('filingyear', 'n_unc_terms')
plot(nterms.by.year$filingyear, nterms.by.year$n_unc_terms, type='l', col='red', lwd=3)
pterms.by.year <- aggregate(mda$p_unc_terms, by = list(mda$filingyear), FUN = mean)
names(pterms.by.year) <- c('filingyear', 'p_unc_terms')
plot(pterms.by.year$filingyear, pterms.by.year$p_unc_terms, type='l', col='red', lwd=3)
pterms.by.year <- aggregate(mda$p_unc_terms, by = list(mda$filingyear), FUN = median)
names(pterms.by.year) <- c('filingyear', 'p_unc_terms')
plot(pterms.by.year$filingyear, pterms.by.year$p_unc_terms, type='l', col='red', lwd=3)
pterms.by.month <- aggregate(mda$p_unc_terms, by = list(mda$filingyearmo), FUN = median)
names(pterms.by.month) <- c('filingyearmo', 'p_unc_terms')
plot(pterms.by.month$filingyearmo, pterms.by.month$p_unc_terms, type='l', col='red', lwd=3)
nterms.by.year <- aggregate(mda$n_unc_terms, by = list(mda$filingyear), FUN = mean)
names(nterms.by.year) <- c('filingyear', 'n_unc_terms')
plot(nterms.by.year$filingyear, nterms.by.year$n_unc_terms, type='l', col='red', lwd=3)
plot(pterms.by.year$filingyear, pterms.by.year$p_unc_terms, type='l', col='red', lwd=3)
terms.by.year <- merge(nterms.by.year, pterms.by.year)
View(terms.by.year)
nterms.by.quarter <- aggregate(mda$n_unc_terms, by = list(mda$filingquarter), FUN = mean)
names(nterms.by.quarter) <- c('filingquarter', 'n_unc_terms')
plot(nterms.by.quarter$filingquarter, nterms.by.quarter$n_unc_terms, type='l', col='red', lwd=3)
filingquarter <- paste(mda$filingyear, ceiling(as.numeric(mda$filingmonth)/3), sep='0')
table(filingquarter)
mda$filingquarter <- filingquarter
nterms.by.quarter <- aggregate(mda$n_unc_terms, by = list(mda$filingquarter), FUN = mean)
names(nterms.by.quarter) <- c('filingquarter', 'n_unc_terms')
plot(nterms.by.quarter$filingquarter, nterms.by.quarter$n_unc_terms, type='l', col='red', lwd=3)
pterms.by.quarter <- aggregate(mda$p_unc_terms, by = list(mda$filingquarter), FUN = median)
names(pterms.by.quarter) <- c('filingquarter', 'p_unc_terms')
plot(pterms.by.month$filingquarter, pterms.by.quarter$p_unc_terms, type='l', col='red', lwd=3)
plot(pterms.by.quarter$filingquarter, pterms.by.quarter$p_unc_terms, type='l', col='red', lwd=3)
library(sas7bdat)
setwd("C:/Users/Reginald/Dropbox/Research/biz-uncertainty/code")
aggs <- read.sas7bdat("../../0_datasets/aggregate.sas7bdat")
View(aggs)
getwd()
aggs.q <- read.sas7bdat("../data/accaggq.sas7bdat")
rm(list=ls())
library(sas7bdat)
aggs.q <- read.sas7bdat("../data/accaggq.sas7bdat")
names(aggs.q) <- tolower(names(aggs.q))
plot(x=aggs.q$datafqtr, y=aggs.q$invest, type='l')
plot(aggs.q$invest, type='l')
View(aggs.q)
o <- which(is.na(aggs.q$datafqtr))
if(length(o)>0) aggs.q <- aggs.q[-o,]
plot(x=aggs.q$datafqtr, y=aggs.q$invest, type='l')
plot(aggs.q$invest, type='l')
View(aggs.q)
o <- which(aggs.q$datafqtr = '')
o <- which(aggs.q$datafqtr == '')
if(length(o)>0) aggs.q <- aggs.q[-o,]
plot(x=aggs.q$datafqtr, y=aggs.q$invest, type='l')
plot(aggs.q$invest, type='l')
